#  正大机器人策划说明文档

# 目录

[TOC]

## 文档状态

| 文件状态 | [  √  ]草稿 | [    ]正式发布 | [    ]正在修改 |
| -------- | ----------- | -------------- | -------------- |
| 当前版本 | v1.0.1      |                |                |
| **修订** | 狄青青      | **日期**       | 2019-6-15      |
| **审核** |             | **日期**       |                |
| **批准** |             | **日期**       |                |



## 修订记录

<p align="right">A - 增加     /     M - 修订     /     D - 删除

| 版本号 | 日期      | 变更类型 | 修改人 | 备注         |
| ------ | --------- | -------- | ------ | ------------ |
| v1.0.0 | 2019-6-15 | A        | 狄青青 | 建立文档     |
| v1.0.1 | 2019-6-20 | A        | 狄青青 | 追加后台描述 |
|        |           |          |        |              |
|        |           |          |        |              |



---



## 一、产品概述

### 1.1 项目背景

​		此项目是泰国CPALL 最为关注和展示形象的工程，产品用于正大集团旗下高端服务便利店，机器人身高约1米，有深度语音交互、机器人视觉、人体感应，自主定位、运动控制、机器人仿生模拟等功能。运用声控识别、自然语言理解、人脸识别，**RFID 信号识别感应**等技术为客户提供人性化的交互式服务。

|                           产品图ID                           |
| :----------------------------------------------------------: |
| ![](https://gitee.com/virus_dq/image/blob/master/CPALL/01-1.jpg) |



### 1.2 产品目标

机器人三大功能方面：问候、提供信息、娱乐。



### 1.3 产品结构

![](https://ws1.sinaimg.cn/large/006QgLKLly1g46a56fzdbj30p91mrdho.jpg)

---



## 二、逻辑需求说明

### 2.1 主干流程

- 机器人开启，胸口、眼睛同步开机并播放开机动画、同时点亮LED灯；

- 机器人开启后，进入**待唤醒页**，处于命令待接收状态，用户可进行声控操作；

- 当机器人处于声控状态时，胸口平板根据当前状态显示对应界面及动画；

- 当机器人关机时，肢体回归默认位置；



### 2.2 对话逻辑

通过唤醒词or人体感应触发，即进入反馈语播报，同时开始计时，计时内，不记拾音次数；

1. 唤醒时，随机播放唤醒反馈语；
2. 获取**有效**文本时，返回拾音结果后，重新进入拾音，重置T，S；
3. 获取**无效**文本时，随机播报引导语，T+1，重置S；
4. 结束时，随机播放结束语；

补充

- 拾音计时时长：10s **（暂定）**
- 结束后保留在当前界面，60s后返回待机页面。

| 名词 | 描述             |
| ---- | ---------------- |
| T    | 引导次数         |
| S    | 时间，单位：s/秒 |



![](https://raw.githubusercontent.com/516748229/picgo/master/%E5%AF%B9%E8%AF%9D%E9%80%BB%E8%BE%91%E6%B5%81%E7%A8%8B.png)



### 2.3 Led灯状态

| 颜色         | 状态                       |
| ------------ | -------------------------- |
| 绿色呼吸     | 正在开机                   |
| 蓝色呼吸     | 进入工作状态               |
| 橙色呼吸     | WIFI异常，无法连接外部网络 |
| 蓝色常亮     | 宣传模式（后台控制开关）   |
| 随机色彩呼吸 | 声控反馈                   |
| 随机色彩     | 舞蹈表演、歌曲点播         |



### 2.4 人体感应

开启后，人体感应器检测到人体，机器人主动发起对话引导；第一次拾音后，移动至声源附近；

触发规则：

- 后台已开启人体感应
- 在待机/宣传模式下 可触发
- 在对话引导页/对话页 可触发

触发间隔：

- 45s



### 2.5 待机逻辑

**进入待机**

当机器人无交互120s后，进入  **默认点**  并进入待机模式，待机状态有2种，根据是否设置宣传图判定：

**状态1**：未设置宣传：进入**待唤醒页**；

**状态2**：已设置宣传：进入宣传轮播状态；

> 默认点通过后台/首页设置

**退出待机**

- 人体感应器被触发（前置条件：人体感应已被开启）

- 唤醒词唤醒；

- [ ] a.待机行为：进入 **状态1** 模式，每隔180s播放一次待机语。

- [ ] b.**待机模式被打断时，均主动进入发起对话引导**

  

## 三、功能需求说明

### 3.1 WIFI

**查看WIFI**

开机后，可通过语音指令“WIFI”、“查看WIFI”查询本机的WIFI名称； 

WIFI需通过管理端配置，当未连接WIFI或WIFI处于无法上网时，LED为橙色呼吸状态；

**配置成功**

成功连接外网后，机器人反馈成功语“WIFI连接成功”



### 3.2 语音交互

机器人通过语音交互，用来触发各项功能和状态显示等；

**语音唤醒**

语音唤醒：通过唤醒词“你好，xx”，将机器人唤醒为接受并识别的可交互状态；唤醒后，机器人主动发起对话引导。

***声源定位**：当语音唤醒后，启动定位声源，机器人移动至声源附近；

> 声源定位逻辑：机器人配合滑轨移动至声源位置，移动时同步播放反馈语，反馈结束后启动拾音。

**语音打断**

在已唤醒且接受识别状态下，可通过语音指令”不说了“、”退出“打断当前反馈及闲聊交互，并返回对话界面；



### 3.3 音量调整

通过语音指令调整机器人音量。

**音量加大**

递增音量：“加大音量”                     //每次递增10%音量

百分比音量：“音量调至百分之X”   例如：音量调至百分之七十

**音量减少**

递减音量：“减少音量”                     //每次递减10%音量

百分比音量：“音量调至百分之X”   例如：音量调至百分之三十

> 音量至100%且继续递增时，播放提示语“我喉咙都快喊破了~”



### 3.4 舞蹈表演

舞蹈通过语音中的   **&关键词 &附属关键词**   作为播放触发，触发时随机反馈一条反馈语。

| 舞蹈名称 | 关键词    | 附属关键词   |
| -------- | --------- | ------------ |
| name     | =舞蹈名称 | key、key1    |
| 小苹果   | 小苹果    | 现代、快乐的 |

> 表格详见 正大机器人数据文案.xls



**执行舞蹈**

语音指令：“舞蹈”、“跳个舞”、“？关键词  &  ？附属关键词”

**终止舞蹈**

语音指令：“你好，xx”

**连续舞蹈/更换舞蹈**

当用户想停止并更换舞蹈，需先终止舞蹈，再通过语音指令“再跳一个”、“再来一个”、“换一个”，可随机触发除当前外舞蹈。

> 其他对话场景，以上语音指令不触发舞蹈。



### 3.5 声控反馈

当云反馈内容超过5S，根据反馈时长，随机组合动作、眼睛ID、LED，匹配时长约等的组合反馈。



### 3.6 声控关机

语音指令：“关机”

二次确认关机：“关机”、“确认”

取消关机：”不关机“、”取消“



---



## 四、原型设计DEMO

### 4.1  前端原型说明

 在线预览地址：http://suo.im/5mSEHw     境外网站，访问较慢。

####  4.1.1 前端逻辑流程图

![](https://raw.githubusercontent.com/516748229/picgo/master/%E9%A1%B5%E9%9D%A2%E6%B5%81%E7%A8%8B%E5%9B%BE.png)



#### 4.1.2 待唤醒页

![](https://raw.githubusercontent.com/516748229/picgo/master/%E9%A6%96%E9%A1%B5%20%E2%80%93%201.png)

开机后，进入待唤醒页，通过“你好，xx”  或  人体感应触发，进入对话引导页；



#### 4.1.3 宣传轮播

![](https://raw.githubusercontent.com/516748229/picgo/master/%E8%BD%AE%E6%92%AD%E9%A1%B5.png)

展示后台设置的宣传图or宣传视频。

视频同比等宽拉伸；



#### 4.1.4 对话引导页

![](https://raw.githubusercontent.com/516748229/picgo/master/%E4%B8%BB%E5%8A%A8%E5%BC%95%E5%AF%BC%E9%A1%B5.png)

1. 进入该页面时，主动触发引导语  **“你好，需要什么帮助吗？”**  并显示引导功能，功能以瓷片区形式表现；

2. 引导文案30s更换一次；

- 购物引导文案构成：**？"商品名称"**   +在哪里；

- 舞蹈表演文案构成：表演+   **？“舞蹈名称”** 或 **跳一支舞、跳个舞** 随机展示；
- 歌曲点播文案构成：
- 闲聊互动文案构成：

> 根据对话内容，触发功能引导或闲聊、表演，分别展示对应界面

在该页面无交互120s后，进入待机模式；



#### 4.1.5 对话页

![](https://raw.githubusercontent.com/516748229/picgo/master/%E9%97%B2%E8%81%8A%E4%BA%92%E5%8A%A8.png)

1. 对话页为聊天记录页，显示本次对话的所有历史记录；

2. 当在此页面触发舞蹈、动画时，进入对应动画显示状态，完成后返回该页面；

> 定义：进入该页面后，无论跳转，打开，切换过多少次其他页面，均不重置本次对话记录；
>
> 重置：当返回待唤醒页or轮播页，再次进入该页面时，视为重新打开；
>
> 定期清理：对话记录每72H清理一次。

3. 在该页面60s无交互时，返回对话引导页；

4. 返回引导页继续产生交互，跳回历史对话；



#### 4.1.6 购物引导

![](https://raw.githubusercontent.com/516748229/picgo/master/%E8%B4%AD%E7%89%A9%E5%BC%95%E5%AF%BC.png)

![](https://raw.githubusercontent.com/516748229/picgo/master/%E8%B4%AD%E7%89%A9%E5%BC%95%E5%AF%BC%20-%201.png)

1. 机器移动方向只有左右，仅设计左右引导动效，引导时，同步播放随机引导语；

2. 引导任务完成后，播放引导结束语并返回对话页，并返回待机位置；



#### 4.1.7 情绪表达

![](https://raw.githubusercontent.com/516748229/picgo/master/%E5%AF%B9%E8%AF%9D%E9%A1%B5%20%E2%80%93%202.png)

情绪表达动画以浮层效果展示，展示后收起。



#### 4.1.8 舞蹈表演

> 详见        三、功能需求说明/4.舞蹈表演

**舞蹈选择**

![](https://raw.githubusercontent.com/516748229/picgo/master/%E8%88%9E%E8%B9%88.png)

通过非关键词触发舞蹈时，需随机调4个舞蹈供用户2次选择，用户通过显示的舞蹈名称触发对应舞蹈。

**舞蹈动画**

![](https://raw.githubusercontent.com/516748229/picgo/master/%E8%88%9E%E8%B9%88%E5%8A%A8%E7%94%BB.png)

舞蹈表演时，循环播放舞蹈至舞蹈结束。



#### 4.1.9 歌曲点播

![](https://raw.githubusercontent.com/516748229/picgo/master/%E6%AD%8C%E6%9B%B2%E7%82%B9%E6%92%AD.png)

![](https://raw.githubusercontent.com/516748229/picgo/master/%E6%AD%8C%E6%9B%B2%E6%92%AD%E6%94%BE.png)

歌曲播放时，循环播放音乐动画，底部需显示音乐时常进度条。



---



### 4.2 后台管理

#### 4.2.1 后台登录

![](https://raw.githubusercontent.com/516748229/picgo/master/%E7%99%BB%E5%BD%95.png)

设备端通过连接机器人WIFI后 ，用户在浏览器上通过WEB网页的方式访问。



#### 4.2.2 后台首页

![](https://raw.githubusercontent.com/516748229/picgo/master/%E9%A6%96%E9%A1%B5.png)

##### 4.2.2.1 模式控制

**用例说明**

| 参与者   | 功能描述                                                     | 前置条件     | 后置条件       |
| -------- | ------------------------------------------------------------ | ------------ | -------------- |
| 系统用户 | 控制已连接机器人开启对应功能<br />宣传模式：机器人在默认点或当前点开始宣传工作<br />人体感应：机器人可通过人体感应器触发主动引导对话 | 已连接机器人 | 执行启动的模式 |

**对象操作**

| 功能序号 | 功能名称 | 功能描述                                                     |
| -------- | :------- | :----------------------------------------------------------- |
| 1        | 宣传模式 | 【输入】<br />【输出】<br />【约束条件】默认关闭，单击切换开、关 |
| 2        | 人体感应 | 【输入】<br />【输出】<br />【约束条件】默认关闭，单击切换开、关 |

**界面约束**

| 数据域   | 数据精度 | 操作方式 | 编辑控制 | 其他说明 |
| -------- | -------- | -------- | -------- | -------- |
| 宣传模式 |          | 单击     |          |          |
| 人体感应 |          | 单击     |          |          |



##### 4.2.2.2 WIFI配置

**用例说明  **

| 参与者   | 功能描述             | 前置条件     | 后置条件 |
| -------- | -------------------- | ------------ | -------- |
| 系统用户 | 为机器人连接外部网络 | 已连接机器人 |          |

**对象操作**

| 功能序号 | 功能名称 | 功能描述                                                     |
| -------- | -------- | :----------------------------------------------------------- |
| 1        | 连接WIFI | 【输入】触发连接WIFI按钮<br />【输出】WIFI配置弹窗<br />【约束条件】 |
| 2        | 当前WIFI | 【输入】<br />【输出】<br />【约束条件】显示WIFI状态         |



**WIFI配置 - 弹窗**

![](https://raw.githubusercontent.com/516748229/picgo/master/__wifi.png)

**对象操作**

| 功能序号 | 功能名称 | 功能描述                                                     |
| -------- | -------- | :----------------------------------------------------------- |
| 1        | 取消     | 【输入】触发取消按钮<br />【输出】关闭弹窗，取消操作<br />【约束条件】 |
| 2        | 确认     | 【输入】触发确认按钮<br />【输出】<br />1.连接成功<br />2.连接失败，显示原因<br />【约束条件】名称与密码为空时不可确认 |

**界面约束**

| 数据域   | 数据精度 | 操作方式    | 编辑控制   | 其他说明           |
| -------- | -------- | ----------- | ---------- | ------------------ |
| WIFI名称 |          | 文本框/下拉 | 查询时可选 | 键入时提示文本隐藏 |
| WIFI密码 |          | 文本框      | 查询时可选 | 键入时提示文本隐藏 |



##### 4.2.2.3 滑轨控制

**用例说明  **

| 参与者   | 功能描述               | 前置条件 | 后置条件 |
| -------- | ---------------------- | -------- | -------- |
| 系统用户 | 控制机器人前往指定滑轨 | 获取FRID |          |

**对象操作**

|      | 功能名称   | 功能描述                                                     |
| ---- | :--------- | :----------------------------------------------------------- |
| 1    | 前往滑轨   | 【输入】触发下拉按钮<br />【输出】下拉显示FRID<br />【约束条件】FRID范围 |
| 2    | 移动       | 【输入】触发移动按钮<br />【输出】<br />1.操作成功  <br />2.操作失败，失败原因<br />【约束条件】前往选择的滑轨 |
| 3    | 默认点     | 【输入】<br />【输出】已设置的FRID<br />【约束条件】<br />1.默认值：未设置 <br />2.设置后保存，直到被覆盖 |
| 4    | 设为默认点 | 【输入】触发设为默认点按钮<br />【输出】<br />1.操作成功  <br />2.操作失败，失败原因<br />【约束条件】选择当前的滑轨为默认点 |

**界面约束**

| 数据域     | 数据精度  | 操作方式 | 编辑控制 | 其他说明                   |
| ---------- | --------- | -------- | -------- | -------------------------- |
| 前往滑轨   | interface | 下拉     |          | 未获取FRID时为不可操作状态 |
| 移动       |           |          |          | 未获取FRID时为不可操作状态 |
| 设为默认点 |           |          |          | 未获取FRID时为不可操作状态 |



##### 4.2.2.4 商品ID

待补充



##### 4.2.2.5  FRID

待补充



##### 4.2.2.6 宣传内容

显示已添加且在有效时间的宣传内容，单击进入该宣传的修改页面；为空时，仅显示新增宣传按钮；

排序：添加时间倒序

**对象操作**

| 功能序号 | 功能名称 | 功能描述                                                     |
| -------- | :------- | :----------------------------------------------------------- |
| 1        | 全部宣传 | 【输入】触发全部宣传按钮<br />【输出】跳转宣传管理页面<br />【约束条件】 |
| 2        | 新增宣传 | 【输入】触发新增宣传按钮<br />【输出】跳转新增宣传页面<br />【约束条件】 |



#### 4.2.3 宣传管理

![](https://raw.githubusercontent.com/516748229/picgo/master/%E5%AE%A3%E4%BC%A0%E7%AE%A1%E7%90%86.png)

**用例说明  **

| 参与者   | 功能描述     | 前置条件     | 后置条件 |
| -------- | ------------ | ------------ | -------- |
| 系统用户 | 新增宣传内容 | 已连接机器人 |          |

**对象操作**

| 功能序号 | 功能名称   | 功能描述                                                     |
| -------- | :--------- | :----------------------------------------------------------- |
| 1        | 选项       | 【输入】触发勾选状态<br />【输出】显示批量删除按钮<br />【约束条件】 |
| 2        | 删除       | 【输入】触发批量删除按钮<br />【输出】弹窗二次确认<br />1.取消   2.确认<br />【约束条件】默认隐藏，勾选批处理后可见 |
| 3        | 新增宣传图 | 【输入】触发新增按钮<br />【输出】跳转新增宣传页<br />【约束条件】 |
| 4        | 编辑       | 【输入】触发编辑按钮<br />【输出】跳转编辑宣传页面<br />【约束条件】 |
| 5        | 删除       | 【输入】触发删除按钮<br />【输出】弹窗二次确认<br />1.取消   2.确认<br />【约束条件】 |

**界面约束**

| 数据域 | 数据精度 | 操作方式 | 编辑控制 | 其他说明 |
| ------ | -------- | -------- | -------- | -------- |
| 选项   |          | 勾选     |          |          |

